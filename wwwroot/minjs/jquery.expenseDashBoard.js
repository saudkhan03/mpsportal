$(document).ready(function(){var e=[],t=(new Date).getFullYear();$("#months").val((new Date).getMonth()+1),$("#monthsConsolidated").val((new Date).getMonth()+1),e.push(t-3,t-2,t-1,t);var o=[];$.each(e,function(e,a){a==t?o.push('<option value="'+a+'" selected >'+a+"</option>"):o.push('<option value="'+a+'" >'+a+"</option>")}),$("#years").html(o.join("")),$("#yearsConsolidated").html(o.join("")),GetDashBoard(t),GetMonthlyDashBoard(Number($("#years").val()),Number($("#months").val())),GetConsolidatedDashboard(t),GetConsolidatedMonthlyDashboard(Number($("#years").val()),Number($("#months").val())),$("#years").change(function(){reset("ExpenseYearlyChart"),GetDashBoard(Number($("#years").val()))}),$("#months").change(function(){reset("ExpenseMonthlyChart"),GetMonthlyDashBoard(Number($("#years").val()),Number($("#months").val()))}),$("#yearsConsolidated").change(function(){reset("ConsolidatedChart"),GetConsolidatedDashboard(Number($("#yearsConsolidated").val()))}),$("#monthsConsolidated").change(function(){reset("ConsolidatedMonthlyChart"),GetConsolidatedMonthlyDashboard(Number($("#yearsConsolidated").val()),Number($("#monthsConsolidated").val()))})});var GetDashBoard=function(e){$.get("/Reports/getExpensesForDashBoard",{year:e},function(e){var n=[],r=[],s=[],a=[],t=[];a.push("rgba(54, 162, 235, 0.2)"),t.push("rgba(54, 162, 235, 1)"),a.push("rgba(0, 163, 53, 0.2)"),t.push("rgba(0, 163, 53, 1)"),$.each(e.expenses,function(e,a){var t=new Date(a[0].expenseDate).getShortMonthName();-1==n.indexOf(t)&&n.push(t);var o=0;$.each(a,function(e,a){o+=Number(a.expenseAmount)}),r.push(o),o=0}),$.each(e.fees,function(e,a){var t=new Date(a[0].paidDate).getShortMonthName();-1==n.indexOf(t)&&n.push(t);var o=0;$.each(a,function(e,a){o+=Number(a.paidFees)}),s.push(o),o=0});var o=document.getElementById("CanExpenseYearlyChart");new Chart(o,{type:"bar",data:{labels:n,datasets:[{label:"Expenses",data:r,backgroundColor:a[0],borderColor:t[0],borderWidth:1},{label:"Fee Payments",data:s,backgroundColor:a[1],borderColor:t[1],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!1}}]}}})})},GetMonthlyDashBoard=function(e,a){$.get("/Reports/getMonthlyExpensesForDashBoard",{year:e,month:a},function(e){var n=[],r=[],s=[],a=[],t=[];a.push("rgba(54, 162, 235, 0.2)"),t.push("rgba(54, 162, 235, 1)"),a.push("rgba(0, 163, 53, 0.2)"),t.push("rgba(0, 163, 53, 1)"),$.each(e.expenses,function(e,a){var t=new Date(a[0].expenseDate).getDate();-1==n.indexOf(t)&&n.push(t);var o=0;$.each(a,function(e,a){o+=Number(a.expenseAmount)}),r.push(o),o=0}),$.each(e.fees,function(e,a){var t=new Date(a[0].paidDate).getDate();-1==n.indexOf(t)&&n.push(t);var o=0;$.each(a,function(e,a){o+=Number(a.paidFees)}),s.push(o),o=0});var o=document.getElementById("CanExpenseMonthlyChart");new Chart(o,{type:"bar",data:{labels:n,datasets:[{label:"Expenses",data:r,backgroundColor:a[0],borderColor:t[0],borderWidth:1},{label:"Fee Payments",data:s,backgroundColor:a[1],borderColor:t[1],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!1}}]}}})})},GetConsolidatedDashboard=function(e){$.get("/Reports/getConsolidatedDashBoard",{year:e},function(e){var a={type:"pie",data:{datasets:[{data:[e.expenses,e.fees],backgroundColor:["rgba(54, 162, 235, 0.4)","rgba(0, 163, 53, 0.4)"],borderColor:["rgba(54, 162, 235, 1)","rgba(0, 163, 53, 1)"],label:"Consolidated chart"}],labels:["Expenses","Fee payments"]},options:{responsive:!0}},t=document.getElementById("CanConsolidatedChart").getContext("2d");new Chart(t,a)})},GetConsolidatedMonthlyDashboard=function(e,a){$.get("/Reports/getConsolidatedMonthlyDashBoard",{year:e,month:a},function(e){var a={type:"pie",data:{datasets:[{data:[e.expenses,e.fees],backgroundColor:["rgba(54, 162, 235, 0.4)","rgba(0, 163, 53, 0.4)"],borderColor:["rgba(54, 162, 235, 1)","rgba(0, 163, 53, 1)"],label:"Consolidated monthly chart"}],labels:["Expenses","Fee payments"]},options:{responsive:!0}},t=document.getElementById("CanConsolidatedMonthlyChart").getContext("2d");new Chart(t,a)})},reset=function(e){$("#Can"+e).remove(),$("#"+e).append('<canvas id="Can'+e+'"><canvas>')};Date.prototype.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.prototype.getMonthName=function(){return this.monthNames[this.getMonth()]},Date.prototype.getShortMonthName=function(){return this.getMonthName().substr(0,3)};