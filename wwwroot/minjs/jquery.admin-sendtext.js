function validateSend(){0<$("#txtTo").val().length&&$("#txtTo").attr("style").indexOf("border:1px solid red")<0&&0<$("#txtBody").val().length&&$("#btnSend").attr("disabled",!1)}$(document).ready(function(){$.get("/Admin/GetRemaining",function(e){$(".loader").hide(),$(".js-remaining").html("<b>"+e+"</b>")});var e="/Admin/LoadStudentsPhoneNos";$("#gridStudents").jqGrid({url:e,datatype:"json",colNames:["StudentId","Active","Name","Roll No.","Class"],colModel:[{name:"studentId",index:"studentId",hidden:!0,align:"center"},{name:"isActive",index:"isActive",width:40,align:"center",formatter:"checkbox",edittype:"checkbox",editoptions:{value:"true:false",defaultValue:"true"}},{name:"studentName",index:"studentName",width:120,align:"center"},{name:"rollNumber",index:"rollNumber",width:70,align:"center"},{name:"grade",index:"grade",width:120,align:"center"}],cmTemplate:{resizable:!1},loadonce:!0,rowNum:5e3,sortname:"Name",viewrecords:!0,sortorder:"asc",multiselect:!0,cmTemplate:{resizable:!0},loadComplete:function(e){}});var t=$("#gridStudents")[0].grid.cDiv;$("#gridStudents").setCaption(""),$("a.ui-jqgrid-titlebar-close",t).unbind(),$(t).hide(),$("#gridStudents").jqGrid("filterToolbar",{stringResult:!0,searchOnEnter:!1,defaultSearch:"cn"});e="/Admin/LoadStaffPhoneNos";$("#gridStaff").jqGrid({url:e,datatype:"json",colNames:["StaffId","Active","Name","Joined on","T/S"],colModel:[{name:"staffId",index:"staffId",hidden:!0,align:"center"},{name:"isActive",index:"isActive",width:40,align:"center",formatter:"checkbox",edittype:"checkbox",editoptions:{value:"true:false",defaultValue:"true"}},{name:"staffName",index:"staffName",width:120,align:"center"},{name:"joiningDate",index:"joiningDate",width:100,align:"center",sorttype:"date",formatter:"date",formatoptions:{newformat:"d-M-Y"},datefmt:"d-M-Y"},{name:"isTeacher",index:"isTeacher",width:70,align:"center"}],cmTemplate:{resizable:!1},loadonce:!0,rowNum:5e3,sortname:"Name",viewrecords:!0,sortorder:"asc",multiselect:!0,cmTemplate:{resizable:!0},loadComplete:function(e){}});t=$("#gridStaff")[0].grid.cDiv;$("#gridStaff").setCaption(""),$("a.ui-jqgrid-titlebar-close",t).unbind(),$(t).hide(),$("#gridStaff").jqGrid("filterToolbar",{stringResult:!0,searchOnEnter:!1,defaultSearch:"cn"}),$(".js-addMails").click(function(){var e="",t=[];e=$("#students").hasClass("active")?"#gridStudents":"#gridStaff",$(e+" input:checked").each(function(){$(this).attr("disabled")||t.push($(this).closest("tr > td").next().html())});var n="";$.each(t,function(e,t){n+=t+";"}),$("#txtTo").val(n.substr(0,n.length-1)),validateSend()}),$("#txtTo").keyup(function(){(function(e){var t=e.split(";"),n=!0;1<t.length&&$.each(t,function(e,t){10!=t.length&&(n=!1)});return n})($("#txtTo").val())?($(this).attr("style","border:1px solid #ccc"),2<$("#txtTo").val().length&&0<$("#txtBody").val().length&&$("#btnSend").attr("disabled",!1)):($(this).attr("style","border:1px solid red"),$("#btnSend").attr("disabled",!0)),validateSend()}),$("#btnSend").click(function(){var e=$("#txtTo").val().split(";"),t=$("#txtBody").val();$(".loader").show(),$.post("/Admin/SendText",{to:e,message:t},function(e){$(".loader").hide(),e.res?(alert("Message sent."),window.location.href="/Home/Index"):alert("Could not send text"+e.exep)})}),$("#txtBody").keyup(function(){validateSend()})});