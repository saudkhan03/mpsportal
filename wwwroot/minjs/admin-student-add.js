var adminmodule=angular.module("app-mps",[]);adminmodule.controller("student-add",["$scope","$http",function(s,e){s.wait=!0,s.loaderMsg="Loading...",e.get("/Admin/LoadAddStudent").then(function(e){var t={gender:"Male",admissionDate:"",dob:"",password:"P@ssw0rd",rollNumber:e.data.rollNumber};s.grades=e.data.grades,s.totalfees=e.data.totalfees,s.slabs=e.data.slabs,s.academicYear=e.data.academicYear,s.student=t,s.wait=!1},function(e){alert(e.statusText),s.wait=!1}),s.getFees=function(){e.get("/Admin/getFee",{params:{slabName:s.student.slabName,grade:s.student.grade}}).then(function(e){0!=e.data&&$("#txtFee").val(e.data)},function(e){alert(e.statusText)})},s.addStudent=function(){s.wait=!0,s.loaderMsg="Creating new student, please wait...",s.student.totalFee=$("#txtFee").val();var e=new Date(Number($("#admissionDate").val().split("-")[2]),Number($("#admissionDate").val().split("-")[1])-1,Number($("#admissionDate").val().split("-")[0])+1,0,0,0).toUTCString();s.student.admissionDate=e;var t=new Date(Number($("#dob").val().split("-")[2]),Number($("#dob").val().split("-")[1])-1,Number($("#dob").val().split("-")[0])+1,0,0,0).toUTCString();s.student.dob=t,a(n)};var a=function(e){var t=document.getElementById("filePic").files[0],a=document.getElementById("aadhaarCard").files[0],n=document.getElementById("fatherAadhaarCard").files[0],d=document.getElementById("motherAadhaarCard").files[0],r=document.getElementById("transferCert").files[0];r1=new FileReader,r2=new FileReader,r3=new FileReader,r4=new FileReader,r5=new FileReader,t&&(r1.addEventListener("load",function(){s.student.studentPic=t.name+"~"+r1.result},!1),r1.readAsDataURL(t)),a&&(r2.addEventListener("load",function(){s.student.aadhaarCard=a.name+"~"+r2.result},!1),r2.readAsDataURL(a)),n&&(r3.addEventListener("load",function(){s.student.fatherAadhaarCard=n.name+"~"+r3.result},!1),r3.readAsDataURL(n)),d&&(r4.addEventListener("load",function(){s.student.motherAadhaarCard=d.name+"~"+r4.result},!1),r4.readAsDataURL(d)),r&&(r5.addEventListener("load",function(){s.student.transferCert=r.name+"~"+r5.result},!1),r5.readAsDataURL(r)),setTimeout(function(){e()},1010)},n=function(){e.post("/Admin/Students",s.student).then(function(e){e.data.res?(s.wait=!1,alert(e.data.status),window.location.href="/Home/Index"):(s.wait=!1,alert(e.data.status+"\n"+e.data.errors.split("-").join("\n")),$("#admissionDate").val(""),$("#dob").val(""))},function(e){alert(e.statusText),$("#admissionDate").val(""),$("#dob").val("")})};s.makeUserName=function(){try{var e=2<s.student.firstName.length?s.student.firstName.substr(0,4).toLocaleLowerCase():s.student.firstName.toLocaleLowerCase(),t=2<s.student.lastName.length?s.student.lastName.substr(0,4).toLocaleLowerCase():s.student.lastName.toLocaleLowerCase()}catch(e){}e&&t&&(s.student.userName=e+"_"+t)},checkUserName=function(){e.get("/Auth/checkUserName?n="+s.student.userName).then(function(e){res},function(e){alert(e.statusText)})}}]);